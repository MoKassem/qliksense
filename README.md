# Qlik Sense Enterprise

## Installation of kustomize

THe version of kustomize being using is the v2.1 line, which as of this writing, is waiting to be released. In the meantime it is necesary to install from head with [Go] v1.10.1 or higher:

```
go get sigs.k8s.io/kustomize
```
Make sure the GOPATH/bin is in your path:

```
export PATH=${GOPATH}/bin:${PATH}
```

You will also need (the go version of) yq installed, available from here (https://mikefarah.github.io/yq/])

Create a convienience function that points to the root of this cloned repo (must be cloned in to folder called "qliksense")

```
function kustomizeIt {
  XDG_CONFIG_HOME="<Root of this repo>" \
  kustomize build --enable_alpha_plugins \
    "<Root of this repo>"/$1
}
```
Then you can run

`kustomizeIt .`

## What's where

The `values.yaml` file is now multiple resource declarations (`kind: HelmValues`) that are used to "transform" the resource that generates the helm charts (`kind: HelmChart`).
These resources are declared in the individual component github repositories that are pulled in as resources transformed by adding the `values` in (`kind: HelmValues`), then excuted as generators which expand the helm charts. 
The pipeline in kustomize is file system tree order. So the parent kustomization.yaml file operates on resources generated by kustomization.yaml files in child directories.  The `values.yaml` is now found in `generators/qliksense/transformers/defaultvalues.yaml`

You will also fine an example patch file for values in `generators/qliksense/transformers`